# 👌倒排索引的结构是什么样的？

### 1. 词典（Dictionary）
词典包含了所有在文档集合中出现的词语。每个词语在词典中都有一个唯一的标识。词典的作用是快速查找某个词语对应的倒排列表。

**示例**：

```plain
词语       | 词语 ID
-------------------
"search"   | 1
"engine"   | 2
"Elasticsearch" | 3
```

### 2. 倒排列表（Posting List）
倒排列表记录了每个词语在哪些文档中出现，以及在每个文档中的具体位置。倒排列表通常包含以下信息：

+ **文档 ID（Document ID）**：表示词语出现的文档。
+ **位置（Position）**：表示词语在文档中的位置。
+ **其他信息**：可能还包括词频（Term Frequency）、词语在文档中的偏移量（Offset）等。

**示例**：

```plain
词语: "search"
倒排列表:
[
  {文档 ID: 1, 位置: [4]},
  {文档 ID: 2, 位置: [7]}
]

词语: "engine"
倒排列表:
[
  {文档 ID: 1, 位置: [5]},
  {文档 ID: 3, 位置: [3]}
]
```

### 3. 词频（Term Frequency）
词频表示某个词语在文档中出现的次数。词频信息可以用于计算文档的相关性评分（如 TF-IDF）。

**示例**：

```plain
词语: "search"
倒排列表:
[
  {文档 ID: 1, 词频: 1, 位置: [4]},
  {文档 ID: 2, 词频: 1, 位置: [7]}
]
```

### 4. 偏移量（Offset）
偏移量表示词语在文档中的起始和结束位置，通常用于高亮显示搜索结果中的匹配词语。

**示例**：

```plain
词语: "search"
倒排列表:
[
  {文档 ID: 1, 偏移量: [(15, 21)]},
  {文档 ID: 2, 偏移量: [(30, 36)]}
]
```

### 5. 文档元数据（Document Metadata）
文档元数据包括文档的其他相关信息，如文档长度、文档类型等。这些信息可以用于查询优化和相关性计算。

**示例**：

```plain
文档 ID: 1
元数据:
{
  长度: 100,
  类型: "article"
}

文档 ID: 2
元数据:
{
  长度: 150,
  类型: "blog post"
}
```

### 完整倒排索引示例
假设我们有以下三个文档：

+ 文档 1: "Elasticsearch is a search engine"
+ 文档 2: "Search engines are important"
+ 文档 3: "Elasticsearch is powerful"

构建的倒排索引可能如下：

**词典**：

```plain
词语           | 词语 ID
-------------------
"Elasticsearch" | 1
"is"            | 2
"a"             | 3
"search"        | 4
"engine"        | 5
"engines"       | 6
"are"           | 7
"important"     | 8
"powerful"      | 9
```

**倒排列表**：

```plain
词语: "Elasticsearch"
倒排列表:
[
  {文档 ID: 1, 位置: [1]},
  {文档 ID: 3, 位置: [1]}
]

词语: "is"
倒排列表:
[
  {文档 ID: 1, 位置: [2]},
  {文档 ID: 3, 位置: [2]}
]

词语: "search"
倒排列表:
[
  {文档 ID: 1, 位置: [4]},
  {文档 ID: 2, 位置: [1]}
]

词语: "engine"
倒排列表:
[
  {文档 ID: 1, 位置: [5]}
]

词语: "engines"
倒排列表:
[
  {文档 ID: 2, 位置: [2]}
]

词语: "are"
倒排列表:
[
  {文档 ID: 2, 位置: [3]}
]

词语: "important"
倒排列表:
[
  {文档 ID: 2, 位置: [4]}
]

词语: "powerful"
倒排列表:
[
  {文档 ID: 3, 位置: [3]}
]
```

### 总结
倒排索引通过将词语映射到文档，使得搜索引擎能够高效地查找包含特定词语的文档。其结构包括词典、倒排列表、词频、偏移量和文档元数据等部分，每个部分都在提升查询效率和搜索精度方面发挥了重要作用。



> 原文: <https://www.yuque.com/jingdianjichi/xyxdsi/ubqpmove5kunkzgp>