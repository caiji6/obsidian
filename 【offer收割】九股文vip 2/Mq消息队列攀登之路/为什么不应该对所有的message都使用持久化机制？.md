# 👌为什么不应该对所有的message 都使用持久化机制？

# 口语化回答
好的，面试官。持久化虽然能保证message不丢失，但是message持久化也会带来一些问题，持久化需要把消息的相关信息存储在磁盘上，在过程中会涉及更多的磁盘I/O，频繁的持久化会让MQ的系统性能下降，影响消息处理和发送，同时也会占用大量的磁盘空间。对于可以接受少量消息丢失的场景，可以考虑不去持久化消息。

以上

# 题目解析
低频题，主要考察消息持久化的缺点

# 题目详细答案
磁盘I/O、性能下降、资源消耗

## 性能开销
持久化操作通常涉及磁盘 I/O 操作，而磁盘 I/O 的速度远低于内存操作。频繁的持久化会导致系统性能下降，包括消息发送和接收的延迟增加。每次消息持久化都需要写入磁盘，增加了消息发送的延迟。高频率的磁盘 I/O 会限制系统的整体吞吐量。

## 资源消耗
持久化消息需要存储在磁盘上，这会占用大量的存储空间。对于高频率、大量的消息传输场景，存储成本会显著增加。大量持久化消息会迅速消耗磁盘空间。

## 复杂性和维护成本
持久化机制增加了系统的复杂性，需要额外的维护和管理。例如，需要定期清理过期的持久化消息，确保磁盘空间的可用性。

## 应用场景需求
并非所有应用场景都需要消息持久化。对于一些实时性要求高但对消息可靠性要求不高的场景，持久化反而会带来不必要的开销。比如实时性要求高的场景：如实时数据流处理、临时通知等，不需要持久化。又比如可靠性要求低的场景：如缓存更新通知、统计数据等，丢失少量消息对系统影响不大。



> 原文: <https://www.yuque.com/jingdianjichi/xyxdsi/rtczrs7piaueuffw>