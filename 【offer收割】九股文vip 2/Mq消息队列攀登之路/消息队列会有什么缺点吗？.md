# 👌消息队列会有什么缺点吗？

[此处为语雀卡片，点击链接查看](https://www.yuque.com/jingdianjichi/xyxdsi/hcr3fgk1a72oubuv#MQ3Hb)

# 口语化回答
好的，面试官，围绕MQ要解决的两大问题来讲它的缺点。第一个是削峰，通过MQ服务来发送和接收处理消息，在过程中就可能会遇到消息丢失、消息延迟比较大、重复消费的问题，为了处理这些问题就需要考虑更多的机制来保障。另外是解耦，虽然每个系统自身业务变得更加清晰有条理，但通过MQ无疑是大大增加系统与系统之间的复杂度，毕竟MQ对接不像接口对接那么清晰方便梳理，因此也加大了系统维护和学习的成本。另外通常需要由各自系统保障数据一致性的问题。

以上

# 面试得分点
这是一道基础必会题，只有知道它的缺点才可能会去避免。消息丢失、延迟、重复消费、系统间的复杂度、数据一致

# 题目详细答案
## 系统复杂性增加
引入消息队列会增加系统的复杂性，包括系统架构、开发和运维的复杂性。需要处理消息的生产、消费、路由、持久化、重试、重复消息处理等问题。

****在一个简单的单体应用中，引入消息队列需要重新设计系统架构，并且需要开发和维护消息生产者和消费者代码，这增加了系统的复杂性。

## 消息丢失风险
尽管大多数消息队列系统提供了消息持久化和重试机制，但在极端情况下（如硬件故障、网络故障等），仍然存在消息丢失的风险。

****在网络分区或硬盘故障的情况下，消息可能会丢失，导致系统无法处理某些关键操作，如订单处理中的支付请求。

## 消息重复
由于网络故障或消费者处理失败，消息队列系统可能会重发消息，这会导致消息重复。消费者需要具备幂等性，能够正确处理重复消息。

****在支付系统中，如果支付请求被重复处理，可能会导致用户被多次扣款。因此，消费者需要确保每个支付请求只被处理一次。

## 延迟
消息队列引入了额外的网络传输和排队时间，这可能会导致消息处理的延迟。对于某些实时性要求高的系统，这可能是一个问题。

在实时交易系统中，消息处理的延迟可能会影响交易的及时性和准确性，进而影响用户体验和系统的可靠性。

## 运维成本
消息队列系统需要专门的运维和监控，确保其高可用性和性能。这包括集群管理、节点监控、日志分析、性能调优等。

****Kafka、RabbitMQ 等消息队列系统需要专门的运维人员进行日常管理和维护，包括集群的扩展、故障处理、性能调优等。

## 一致性问题
在分布式系统中，使用消息队列可能会导致数据一致性问题。需要设计合理的事务管理和一致性保障机制。

在订单系统中，订单创建和库存扣减需要保证一致性。如果订单创建成功但库存扣减失败，可能会导致数据不一致，需要设计补偿机制来处理这种情况。



> 原文: <https://www.yuque.com/jingdianjichi/xyxdsi/hcr3fgk1a72oubuv>