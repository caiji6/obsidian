# 👌TCP三次握手四次挥手?

TCP（传输控制协议）是一个面向连接的协议，确保数据在两个主机之间可靠传输。TCP连接的建立和终止分别通过“三次握手”和“四次挥手”机制来实现。

### 三次握手（建立连接）
1. **第一次握手（SYN）**：
    - 客户端向服务器发送一个SYN（同步序列号）报文段，请求建立连接。
    - 报文段中包含一个初始序列号（Sequence Number），如SYN=1, Seq=x。

```plain
Client: SYN, Seq=x
```

1. **第二次握手（SYN-ACK）**：
    - 服务器收到SYN报文后，确认收到，并向客户端发送一个SYN-ACK报文段。
    - 该报文段包含服务器的初始序列号（Seq=y）和对客户端SYN报文的确认号（Acknowledgment Number），即Ack=x+1。

```plain
Server: SYN, ACK, Seq=y, Ack=x+1
```

1. **第三次握手（ACK）**：
    - 客户端收到SYN-ACK报文后，向服务器发送一个ACK报文段，确认收到服务器的SYN报文。
    - 该报文段包含确认号（Ack=y+1）。

```plain
Client: ACK, Seq=x+1, Ack=y+1
```

经过三次握手，客户端和服务器之间的连接正式建立，可以开始传输数据。

### 四次挥手（终止连接）
1. **第一次挥手（FIN）**：
    - 客户端向服务器发送一个FIN（终止连接）报文段，表示客户端不再发送数据，但仍可以接收数据。
    - 报文段中包含一个序列号（Seq=u）。

```plain
Client: FIN, Seq=u
```

1. **第二次挥手（ACK）**：
    - 服务器收到FIN报文后，向客户端发送一个ACK报文段，确认收到客户端的FIN报文。
    - 该报文段包含确认号（Ack=u+1）。

```plain
Server: ACK, Seq=v, Ack=u+1
```

1. **第三次挥手（FIN）**：
    - 服务器向客户端发送一个FIN报文段，表示服务器也不再发送数据。
    - 报文段中包含一个序列号（Seq=w）。

```plain
Server: FIN, Seq=w
```

1. **第四次挥手（ACK）**：
    - 客户端收到服务器的FIN报文后，向服务器发送一个ACK报文段，确认收到服务器的FIN报文。
    - 该报文段包含确认号（Ack=w+1）。

```plain
Client: ACK, Seq=u+1, Ack=w+1
```

经过四次挥手，客户端和服务器之间的连接正式终止。

### 总结
+ **三次握手**：确保客户端和服务器双方都知道对方的发送和接收能力，建立可靠的传输连接。
+ **四次挥手**：确保双方都能完成数据传输，并有序地终止连接，确保所有数据都被正确接收。



> 原文: <https://www.yuque.com/jingdianjichi/xyxdsi/nhok8k415gf87xhg>