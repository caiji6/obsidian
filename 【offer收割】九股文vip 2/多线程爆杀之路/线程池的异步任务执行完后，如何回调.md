# ğŸ‘Œçº¿ç¨‹æ± çš„å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå¦‚ä½•å›è°ƒ

# é¢˜ç›®è¯¦ç»†ç­”æ¡ˆ
## ä½¿ç”¨Futureå’ŒCallable
Futureæ¥å£æä¾›äº†ä¸€ç§æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆã€è·å–ä»»åŠ¡ç»“æœçš„æ–¹æ³•ã€‚å¯ä»¥é€šè¿‡è½®è¯¢Future.isDone()æ–¹æ³•æ¥æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œæˆ–è€…ç›´æ¥è°ƒç”¨Future.get()æ–¹æ³•æ¥è·å–ç»“æœï¼ˆæ­¤æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ä»»åŠ¡å®Œæˆï¼‰ã€‚

```plain
ExecutorService executor = Executors.newFixedThreadPool(10);
Callable<String> task = () -> {
    // æ‰§è¡Œä»»åŠ¡
    return "Task Result";
};

Future<String> future = executor.submit(task);

// è½®è¯¢æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å®Œæˆ
while (!future.isDone()) {
    // å¯ä»¥åšå…¶ä»–äº‹æƒ…
}

// è·å–ä»»åŠ¡ç»“æœ
try {
    String result = future.get();
    // ä»»åŠ¡å®Œæˆåçš„å›è°ƒå¤„ç†
    System.out.println("Task completed with result: " + result);
} catch (InterruptedException | ExecutionException e) {
    e.printStackTrace();
}
```

## ä½¿ç”¨CompletionService
CompletionServiceæä¾›äº†ä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ç»“æœã€‚å®ƒå¯ä»¥å°†ä»»åŠ¡æäº¤åˆ°çº¿ç¨‹æ± ï¼Œå¹¶åœ¨ä»»åŠ¡å®Œæˆåç«‹å³å¤„ç†ç»“æœã€‚

```plain
ExecutorService executor = Executors.newFixedThreadPool(10);
CompletionService<String> completionService = new ExecutorCompletionService<>(executor);

Callable<String> task = () -> {
    // æ‰§è¡Œä»»åŠ¡
    return "Task Result";
};

completionService.submit(task);

// è·å–å¹¶å¤„ç†ä»»åŠ¡ç»“æœ
try {
    Future<String> future = completionService.take(); // é˜»å¡ç›´åˆ°æœ‰ä»»åŠ¡å®Œæˆ
    String result = future.get();
    // ä»»åŠ¡å®Œæˆåçš„å›è°ƒå¤„ç†
    System.out.println("Task completed with result: " + result);
} catch (InterruptedException | ExecutionException e) {
    e.printStackTrace();
}
```

## ä½¿ç”¨CompletableFuture
CompletableFutureæ˜¯ Java 8 å¼•å…¥çš„ä¸€ä¸ªç±»ï¼Œæä¾›äº†æ›´å¼ºå¤§çš„å¼‚æ­¥ç¼–ç¨‹èƒ½åŠ›ã€‚å®ƒå…è®¸åœ¨ä»»åŠ¡å®Œæˆåæ‰§è¡Œå›è°ƒæ“ä½œã€‚

```plain
CompletableFuture.supplyAsync(() -> {
    // æ‰§è¡Œä»»åŠ¡
    return "Task Result";
}).thenAccept(result -> {
    // ä»»åŠ¡å®Œæˆåçš„å›è°ƒå¤„ç†
    System.out.println("Task completed with result: " + result);
});
```

## ä½¿ç”¨è‡ªå®šä¹‰å›è°ƒæ¥å£
å¯ä»¥å®šä¹‰ä¸€ä¸ªå›è°ƒæ¥å£ï¼Œå¹¶åœ¨ä»»åŠ¡å®Œæˆåè°ƒç”¨å›è°ƒæ–¹æ³•ã€‚

```plain
// å®šä¹‰å›è°ƒæ¥å£
interface Callback {
    void onComplete(String result);
}

// å®ç°å›è°ƒæ¥å£
class MyCallback implements Callback {
    @Override
    public void onComplete(String result) {
        System.out.println("Task completed with result: " + result);
    }
}

// æäº¤ä»»åŠ¡å¹¶åœ¨å®Œæˆåå›è°ƒ
ExecutorService executor = Executors.newFixedThreadPool(10);
Callback callback = new MyCallback();

executor.submit(() -> {
    String result = "Task Result"; // æ‰§è¡Œä»»åŠ¡
    callback.onComplete(result); // è°ƒç”¨å›è°ƒ
});
```

## ä½¿ç”¨FutureTask
FutureTaskæ˜¯ä¸€ä¸ªåŒæ—¶å®ç°äº†Runnableå’ŒFutureçš„ç±»ï¼Œå¯ä»¥åœ¨ä»»åŠ¡å®Œæˆåæ‰§è¡Œå›è°ƒæ“ä½œã€‚

```plain
ExecutorService executor = Executors.newFixedThreadPool(10);

FutureTask<String> futureTask = new FutureTask<>(() -> {
    // æ‰§è¡Œä»»åŠ¡
    return "Task Result";
}) {
    @Override
    protected void done() {
        try {
            String result = get();
            // ä»»åŠ¡å®Œæˆåçš„å›è°ƒå¤„ç†
            System.out.println("Task completed with result: " + result);
        } catch (InterruptedException | ExecutionException e) {
            e.printStackTrace();
        }
    }
};

executor.submit(futureTask);
```



> åŸæ–‡: <https://www.yuque.com/jingdianjichi/xyxdsi/speifqun03eokxgt>