# ğŸ‘Œçº¿ç¨‹é—´çš„é€šä¿¡æ–¹å¼

# é¢˜ç›®è¯¦ç»†ç­”æ¡ˆ
ä¸åŒçš„çº¿ç¨‹é—´é€šä¿¡æ–¹å¼é€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚å…±äº«å†…å­˜å’ŒåŸå­å˜é‡é€‚ç”¨äºç®€å•çš„æ•°æ®å…±äº«ï¼Œç­‰å¾…/é€šçŸ¥æœºåˆ¶é€‚ç”¨äºå¤æ‚çš„åŒæ­¥éœ€æ±‚ï¼Œç®¡é“æµé€‚ç”¨äºæµå¼æ•°æ®ä¼ è¾“ï¼Œé˜»å¡é˜Ÿåˆ—é€‚ç”¨äºç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œè€Œçº¿ç¨‹æ± å’ŒFutureåˆ™é€‚ç”¨äºä»»åŠ¡å¹¶è¡Œæ‰§è¡Œå’Œç»“æœè·å–ã€‚

## å…±äº«å†…å­˜
### å…±äº«å˜é‡
çº¿ç¨‹å¯ä»¥é€šè¿‡å…±äº«å˜é‡è¿›è¡Œé€šä¿¡ã€‚è¿™æ˜¯æœ€ç›´æ¥çš„æ–¹å¼ï¼Œä½†éœ€è¦æ³¨æ„åŒæ­¥é—®é¢˜ï¼Œä»¥é¿å…æ•°æ®ç«äº‰å’Œä¸€è‡´æ€§é—®é¢˜ã€‚

```plain
class SharedData {
    private int value;

    public synchronized void setValue(int value) {
        this.value = value;
    }

    public synchronized int getValue() {
        return value;
    }
}
```

### Volatile å˜é‡
volatileå…³é”®å­—å¯ä»¥ç¡®ä¿å˜é‡çš„å¯è§æ€§ï¼Œå³ä¸€ä¸ªçº¿ç¨‹å¯¹å˜é‡çš„ä¿®æ”¹å¯¹äºå…¶ä»–çº¿ç¨‹æ˜¯å¯è§çš„ã€‚

```plain
class VolatileExample {
    private volatile boolean flag = false;

    public void setFlag() {
        flag = true;
    }

    public void checkFlag() {
        while (!flag) {
            // Busy-wait
        }
        System.out.println("Flag is set!");
    }
}
```

### åŸå­å˜é‡
Java æä¾›äº†ä¸€äº›åŸå­å˜é‡ï¼ˆå¦‚AtomicIntegerã€AtomicBooleanï¼‰æ¥ç®€åŒ–åŒæ­¥æ“ä½œã€‚

```plain
import java.util.concurrent.atomic.AtomicInteger;

class AtomicExample {
    private AtomicInteger count = new AtomicInteger(0);

    public void increment() {
        count.incrementAndGet();
    }

    public int getCount() {
        return count.get();
    }
}
```

## ç­‰å¾…/é€šçŸ¥æœºåˆ¶
Java æä¾›äº†wait()ã€notify()å’ŒnotifyAll()æ–¹æ³•æ¥å®ç°çº¿ç¨‹é—´çš„ç­‰å¾…å’Œé€šçŸ¥æœºåˆ¶ã€‚è¿™äº›æ–¹æ³•å¿…é¡»åœ¨åŒæ­¥å—ä¸­è°ƒç”¨ã€‚

```plain
class WaitNotifyExample {
    private final Object lock = new Object();
    private boolean condition = false;

    public void waitForCondition() throws InterruptedException {
        synchronized (lock) {
            while (!condition) {
                lock.wait();
            }
            System.out.println("Condition met!");
        }
    }

    public void setCondition() {
        synchronized (lock) {
            condition = true;
            lock.notify();
        }
    }
}
```

## ç®¡é“æµ
ç®¡é“æµ (PipedInputStreamå’ŒPipedOutputStream) æä¾›äº†ä¸€ç§çº¿ç¨‹é—´é€šä¿¡çš„æ–¹å¼ï¼Œç±»ä¼¼äº UNIX ä¸­çš„ç®¡é“ã€‚

```plain
import java.io.PipedInputStream;
import java.io.PipedOutputStream;
import java.io.IOException;

class PipeExample {
    public static void main(String[] args) throws IOException {
        PipedInputStream pis = new PipedInputStream();
        PipedOutputStream pos = new PipedOutputStream(pis);

        Thread writer = new Thread(() -> {
            try {
                pos.write("Hello, World!".getBytes());
                pos.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        });

        Thread reader = new Thread(() -> {
            try {
                int data;
                while ((data = pis.read()) != -1) {
                    System.out.print((char) data);
                }
                pis.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        });

        writer.start();
        reader.start();
    }
}
```

## é˜»å¡é˜Ÿåˆ—
Java çš„java.util.concurrentåŒ…æä¾›äº†å¤šç§é˜»å¡é˜Ÿåˆ—ï¼ˆå¦‚ArrayBlockingQueueã€LinkedBlockingQueueï¼‰ï¼Œç”¨äºçº¿ç¨‹é—´çš„å®‰å…¨é€šä¿¡ã€‚

```plain
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.BlockingQueue;

class BlockingQueueExample {
    public static void main(String[] args) {
        BlockingQueue<String> queue = new ArrayBlockingQueue<>(10);

        Thread producer = new Thread(() -> {
            try {
                queue.put("Message");
                System.out.println("Produced message");
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        });

        Thread consumer = new Thread(() -> {
            try {
                String message = queue.take();
                System.out.println("Consumed message: " + message);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
            }
        });

        producer.start();
        consumer.start();
    }
}
```

## çº¿ç¨‹æ± å’ŒFuture
ä½¿ç”¨çº¿ç¨‹æ± å’ŒFutureå¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†å’Œè·å–çº¿ç¨‹æ‰§è¡Œçš„ç»“æœã€‚

```plain
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;

class FutureExample {
    public static void main(String[] args) throws Exception {
        ExecutorService executor = Executors.newFixedThreadPool(2);
        Future<String> future = executor.submit(() -> {
            Thread.sleep(1000);
            return "Result";
        });

        System.out.println("Waiting for result...");
        String result = future.get();
        System.out.println("Got result: " + result);

        executor.shutdown();
    }
}
```





> åŸæ–‡: <https://www.yuque.com/jingdianjichi/xyxdsi/crn4ws8wdmdb3ghq>