# 👌什么是乐观锁？

# 题目详细答案
乐观锁是一种并发控制机制，主要用于解决并发修改问题。与悲观锁不同，乐观锁假设并发冲突的概率较低，因此在操作之前不加锁，而是在操作提交时进行冲突检测。

## 乐观锁的工作原理
乐观锁通常通过以下两种方式实现：

### 版本号
1、 每条记录增加一个版本号字段。

2、 在读取记录时，读取其版本号。

3、 在更新记录时，检查当前版本号是否与读取时的版本号一致。

4、 如果一致，则更新记录并将版本号加一。

5、 如果不一致，则说明有其他事务已经更新了该记录，此时需要重新读取并尝试更新。

### 时间戳
1、 每条记录增加一个时间戳字段。

2、 在读取记录时，读取其时间戳。

3、 在更新记录时，检查当前时间戳是否与读取时的时间戳一致。

4、 如果一致，则更新记录并更新时间戳。

5、 如果不一致，则说明有其他事务已经更新了该记录，此时需要重新读取并尝试更新。

## 适用场景
**读多写少**：系统中读操作频繁，但写操作较少。例如，电商系统中的商品查询操作。

**低冲突**：并发冲突概率较低的场景。例如，用户个人信息修改，每个用户只会修改自己的信息。

## 优缺点
#### 优点
**无锁开销**：乐观锁不需要在读取时加锁，避免了锁的开销和潜在的死锁问题。

**高并发性能**：适用于读多写少的场景，能提高系统的并发性能。

#### 缺点
**重试机制**：当并发冲突发生时，需要重新读取数据并重试更新，可能会增加系统的复杂度。

**不适用高冲突场景**：在并发冲突频繁的场景下，重试次数可能较多，反而降低系统性能。



> 原文: <https://www.yuque.com/jingdianjichi/xyxdsi/aqoetnwecbutp0hh>