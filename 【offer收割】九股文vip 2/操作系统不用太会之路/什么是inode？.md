# 👌什么是 inode？

在Linux和其他类Unix操作系统中，inode（索引节点，index node）是文件系统中存储文件元数据的结构体。每个文件或目录在文件系统中都有一个对应的inode，它包含了文件的元数据（metadata），但不包含文件的实际数据或文件名。

### inode 包含的信息
一个inode通常包含以下信息：

1. **文件类型和权限**：文件的类型（如普通文件、目录、符号链接等）以及文件的访问权限（读、写、执行）。
2. **所有者信息**：文件的所有者（UID）和所在组（GID）。
3. **文件大小**：文件的字节数。
4. **时间戳**：
    - **访问时间（atime）**：文件最后一次被访问的时间。
    - **修改时间（mtime）**：文件内容最后一次被修改的时间。
    - **状态改变时间（ctime）**：文件元数据（如权限、所有者等）最后一次被修改的时间。
5. **链接计数**：指向该inode的硬链接数量。这个计数器用于跟踪有多少个文件名指向同一个inode。
6. **数据块指针**：指向文件数据块的指针。实际的数据存储在这些数据块中，inode通过这些指针来定位文件数据。

### inode 不包含的信息
inode不包含文件名。文件名和inode编号之间的映射关系存储在目录结构中。当你访问一个文件时，系统会通过目录查找文件名对应的inode编号，然后通过inode读取文件的元数据和数据块指针。

### inode 的作用
1. **文件管理**：inode使得文件系统能够高效地管理和访问文件的元数据和数据块。
2. **硬链接**：由于inode编号是文件的唯一标识，多个文件名可以通过硬链接指向同一个inode，从而共享同一文件数据。
3. **文件系统完整性**：inode结构有助于维护文件系统的完整性和一致性，特别是在文件系统检查和修复过程中（如使用`fsck`工具）。

### 查看 inode 信息
你可以使用`ls -i`命令查看文件的inode编号：

```plain
$ ls -i
12345 file1.txt
12346 file2.txt
```

你还可以使用`stat`命令查看文件的详细inode信息：

```plain
$ stat file1.txt
```

输出示例：

```plain
File: file1.txt
  Size: 14              Blocks: 8          IO Block: 4096   regular file
Device: 801h/2049d      Inode: 12345       Links: 1
Access: (0644/-rw-r--r--)  Uid: ( 1000/   user)   Gid: ( 1000/   user)
Access: 2024-07-24 10:00:00.000000000 +0000
Modify: 2024-07-24 10:00:00.000000000 +0000
Change: 2024-07-24 10:00:00.000000000 +0000
 Birth: -
```

### inode 的限制
1. **数量有限**：每个文件系统在创建时会分配固定数量的inode。文件系统中可创建的文件数量受到inode数量的限制。即使磁盘空间未满，如果inode耗尽，你将无法再创建新文件。
2. **碎片化**：由于inode和数据块分开存储，文件数据可能会分散在磁盘的不同位置，导致文件系统碎片化。

inode是Linux文件系统中用于存储文件元数据的结构体。它包含了文件的类型、权限、所有者、大小、时间戳、链接计数和数据块指针等信息。inode不包含文件名，文件名与inode的映射关系存储在目录结构中。通过inode，文件系统能够高效地管理和访问文件，提高文件管理的灵活性和可靠性。



> 原文: <https://www.yuque.com/jingdianjichi/xyxdsi/sxbb94c7hgnxbu36>