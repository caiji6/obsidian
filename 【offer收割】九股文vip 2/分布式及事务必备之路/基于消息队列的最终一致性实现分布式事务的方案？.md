# ðŸ‘ŒåŸºäºŽæ¶ˆæ¯é˜Ÿåˆ—çš„æœ€ç»ˆä¸€è‡´æ€§å®žçŽ°åˆ†å¸ƒå¼äº‹åŠ¡çš„æ–¹æ¡ˆï¼Ÿ

åŸºäºŽæ¶ˆæ¯é˜Ÿåˆ—çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆæ˜¯ä¸€ç§å¸¸è§çš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«é€‚ç”¨äºŽå¾®æœåŠ¡æž¶æž„ä¸­çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚è¯¥æ–¹æ¡ˆçš„æ ¸å¿ƒæ€æƒ³æ˜¯åˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ¥ç¡®ä¿å„ä¸ªå­ç³»ç»Ÿæˆ–æœåŠ¡ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ï¼Œå³ä½¿åœ¨ç³»ç»Ÿå‘ç”Ÿæ•…éšœçš„æƒ…å†µä¸‹ï¼Œæœ€ç»ˆä¹Ÿèƒ½è¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚

### åŸºäºŽæ¶ˆæ¯é˜Ÿåˆ—çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆçš„å…³é”®æ­¥éª¤
1. **ä¸šåŠ¡æ“ä½œä¸Žæ¶ˆæ¯å‘é€çš„äº‹åŠ¡æ€§ä¿è¯**
2. **æ¶ˆæ¯é˜Ÿåˆ—çš„å¯é æŠ•é€’**
3. **å­ç³»ç»Ÿçš„å¹‚ç­‰æ€§å¤„ç†**
4. **æ¶ˆæ¯é‡è¯•æœºåˆ¶**

### è¯¦ç»†æµç¨‹
#### 1. ä¸šåŠ¡æ“ä½œä¸Žæ¶ˆæ¯å‘é€çš„äº‹åŠ¡æ€§ä¿è¯
åœ¨æ‰§è¡Œä¸šåŠ¡æ“ä½œæ—¶ï¼Œéœ€è¦å°†ä¸šåŠ¡æ“ä½œå’Œæ¶ˆæ¯å‘é€ä½œä¸ºä¸€ä¸ªåŽŸå­æ“ä½œæ¥å¤„ç†ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®žçŽ°ï¼š

+ **æœ¬åœ°äº‹åŠ¡æ¶ˆæ¯ï¼ˆäº‹åŠ¡æ¶ˆæ¯ï¼‰**ï¼šä½¿ç”¨æ”¯æŒäº‹åŠ¡æ¶ˆæ¯çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚RocketMQï¼‰ï¼Œåœ¨æœ¬åœ°äº‹åŠ¡ä¸­åŒæ—¶è¿›è¡Œä¸šåŠ¡æ“ä½œå’Œæ¶ˆæ¯å‘é€ã€‚æ¶ˆæ¯é˜Ÿåˆ—ä¼šç¡®ä¿æ¶ˆæ¯çš„å¯é æŠ•é€’ã€‚
+ **äº‹ä»¶è¡¨**ï¼šåœ¨ä¸šåŠ¡æ“ä½œæ‰€åœ¨çš„æ•°æ®åº“ä¸­å¢žåŠ ä¸€ä¸ªäº‹ä»¶è¡¨ï¼Œå°†ä¸šåŠ¡æ“ä½œå’Œäº‹ä»¶è®°å½•ï¼ˆæ¶ˆæ¯ï¼‰æ”¾åœ¨åŒä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¸­æäº¤ã€‚ä¹‹åŽç”±ä¸€ä¸ªç‹¬ç«‹çš„æ¶ˆæ¯å‘é€æœåŠ¡å®šæœŸæ‰«æäº‹ä»¶è¡¨ï¼Œå°†äº‹ä»¶è½¬æ¢ä¸ºæ¶ˆæ¯å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ã€‚

#### 2. æ¶ˆæ¯é˜Ÿåˆ—çš„å¯é æŠ•é€’
æ¶ˆæ¯é˜Ÿåˆ—éœ€è¦ä¿è¯æ¶ˆæ¯çš„å¯é æŠ•é€’ï¼Œé€šå¸¸é€šè¿‡ä»¥ä¸‹æœºåˆ¶å®žçŽ°ï¼š

+ **æŒä¹…åŒ–å­˜å‚¨**ï¼šæ¶ˆæ¯é˜Ÿåˆ—å°†æ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œç¡®ä¿åœ¨ç³»ç»Ÿæ•…éšœæ—¶æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚
+ **ç¡®è®¤æœºåˆ¶**ï¼šæ¶ˆæ¯æ¶ˆè´¹è€…åœ¨æˆåŠŸå¤„ç†æ¶ˆæ¯åŽï¼Œå‘é€ç¡®è®¤ï¼ˆACKï¼‰ç»™æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åœ¨æ”¶åˆ°ç¡®è®¤åŽæ‰åˆ é™¤æ¶ˆæ¯ã€‚

#### 3. å­ç³»ç»Ÿçš„å¹‚ç­‰æ€§å¤„ç†
æ¶ˆæ¯æ¶ˆè´¹è€…åœ¨å¤„ç†æ¶ˆæ¯æ—¶éœ€è¦ä¿è¯å¹‚ç­‰æ€§ï¼Œå³ç›¸åŒçš„æ¶ˆæ¯å³ä½¿è¢«å¤šæ¬¡å¤„ç†ï¼Œç»“æžœä¹Ÿåº”ä¸€è‡´ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š

+ **å”¯ä¸€æ€§çº¦æŸ**ï¼šåœ¨æ•°æ®åº“ä¸­å¯¹ä¸šåŠ¡æ“ä½œè®¾ç½®å”¯ä¸€æ€§çº¦æŸï¼Œé˜²æ­¢é‡å¤æ“ä½œã€‚
+ **çŠ¶æ€æ£€æŸ¥**ï¼šåœ¨å¤„ç†æ¶ˆæ¯å‰æ£€æŸ¥æ“ä½œæ˜¯å¦å·²ç»æ‰§è¡Œè¿‡ã€‚

#### 4. æ¶ˆæ¯é‡è¯•æœºåˆ¶
ä¸ºäº†ç¡®ä¿æ¶ˆæ¯èƒ½å¤Ÿè¢«æˆåŠŸå¤„ç†ï¼Œéœ€è¦å®žçŽ°æ¶ˆæ¯é‡è¯•æœºåˆ¶ï¼š

+ **å®šæ—¶é‡è¯•**ï¼šæ¶ˆæ¯é˜Ÿåˆ—åœ¨æ¶ˆæ¯å¤„ç†å¤±è´¥æ—¶ï¼ŒæŒ‰ç…§ä¸€å®šçš„ç­–ç•¥ï¼ˆå¦‚æŒ‡æ•°é€€é¿ï¼‰è¿›è¡Œé‡è¯•ã€‚
+ **æ­»ä¿¡é˜Ÿåˆ—**ï¼šå¯¹äºŽå¤šæ¬¡é‡è¯•ä»ç„¶å¤±è´¥çš„æ¶ˆæ¯ï¼Œæ”¾å…¥æ­»ä¿¡é˜Ÿåˆ—è¿›è¡Œäººå·¥å¹²é¢„æˆ–åŽç»­å¤„ç†ã€‚

### è¯¦ç»†æµç¨‹å›¾
```plain
Service A                           Message Queue                      Service B
   |                                     |                                 |
   |-- Execute Business Logic ---------> |                                 |
   |                                     |                                 |
   |-- Send Message -------------------->|                                 |
   |                                     |                                 |
   |                                     |-- Deliver Message ------------> |
   |                                     |                                 |
   |                                     |<-- Acknowledge (ACK) -----------|
   |                                     |                                 |
   |                                     |                                 |
   |                                     |-- Retry (if no ACK) ----------> |
   |                                     |                                 |
   |                                     |-- Move to Dead Letter Queue --->|
   |                                     |                                 |
```

### ä¼˜ç¼ºç‚¹
**ä¼˜ç‚¹ï¼š**

+ **é«˜å¯ç”¨æ€§**ï¼šå³ä½¿åœ¨éƒ¨åˆ†ç³»ç»Ÿæ•…éšœçš„æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥ç¡®ä¿æ¶ˆæ¯æœ€ç»ˆè¢«å¤„ç†ã€‚
+ **æ¾è€¦åˆ**ï¼šå„ä¸ªå­ç³»ç»Ÿé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ï¼Œé™ä½Žäº†ç³»ç»Ÿä¹‹é—´çš„è€¦åˆåº¦ã€‚
+ **æ‰©å±•æ€§å¥½**ï¼šæ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥è½»æ¾æ‰©å±•ä»¥å¤„ç†å¤§é‡æ¶ˆæ¯ã€‚

**ç¼ºç‚¹ï¼š**

+ **å»¶è¿Ÿ**ï¼šç”±äºŽæ¶ˆæ¯çš„å¼‚æ­¥å¤„ç†ï¼Œå¯èƒ½ä¼šå¼•å…¥ä¸€å®šçš„å»¶è¿Ÿï¼Œå¯¼è‡´æœ€ç»ˆä¸€è‡´æ€§ã€‚
+ **å¤æ‚æ€§**ï¼šéœ€è¦å¤„ç†æ¶ˆæ¯é‡å¤ã€é¡ºåºé—®é¢˜å’Œå¹‚ç­‰æ€§ç­‰å¤æ‚é—®é¢˜ã€‚

### æ€»ç»“
åŸºäºŽæ¶ˆæ¯é˜Ÿåˆ—çš„æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆæ˜¯ä¸€ç§æœ‰æ•ˆçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«é€‚ç”¨äºŽéœ€è¦é«˜å¯ç”¨æ€§å’Œæ‰©å±•æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚é€šè¿‡åˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„å¯é æŠ•é€’æœºåˆ¶å’Œå­ç³»ç»Ÿçš„å¹‚ç­‰æ€§å¤„ç†ï¼Œå¯ä»¥ç¡®ä¿ç³»ç»Ÿåœ¨å‘ç”Ÿæ•…éšœæ—¶ä»èƒ½ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚



> åŽŸæ–‡: <https://www.yuque.com/jingdianjichi/xyxdsi/il3mes83obtqpt95>